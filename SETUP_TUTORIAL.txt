Fulloch HA + GHCR Setup Tutorial (Environment-Only)
===================================================

This project is now fully environment-driven.
No runtime config.yml is required.

1) GitHub Repository Setup
--------------------------
Repository: https://github.com/k0walski8/fulloch-hagp

Required:
- Main branch exists (main)
- GitHub Actions enabled
- Actions workflow permission: Read and write

2) GHCR Setup
-------------
Images:
- ghcr.io/k0walski8/fulloch-hagp:latest
- ghcr.io/k0walski8/fulloch-hagp:gpu-latest

If package is private:
- Create GitHub PAT with read:packages
- docker login ghcr.io -u k0walski8

3) Publish Flow
---------------
Push to main triggers:
- .github/workflows/docker-publish.yml
- Publishes CPU and GPU images

4) Deployment Host Setup
------------------------
Requirements:
- Docker Engine
- Docker Compose plugin

Files needed:
- compose.yml (CPU) or compose_gpu.yml (GPU)
- .env
- ./data/models and ./data/voices

Run CPU:
- docker compose -f compose.yml pull
- docker compose -f compose.yml up -d

Run GPU:
- docker compose -f compose_gpu.yml pull
- docker compose -f compose_gpu.yml up -d

Health check:
- curl http://<host>:8000/health

5) Required Environment Variables
---------------------------------
Minimum runtime:
- FULLOCH_USE_AI=true
- FULLOCH_USE_TINY_ASR=false
- FULLOCH_USE_TINY_TTS=false
- FULLOCH_VOICE_CLONE=cori
- FULLOCH_HOST=0.0.0.0
- FULLOCH_PORT=8000
- FULLOCH_API_KEY=
- FULLOCH_CHAT_MODEL=fulloch-qwen3-slm
- FULLOCH_STT_MODEL=qwen3-asr-1.7b
- FULLOCH_TTS_MODEL=qwen3-tts-1.7b

6) Web Search Setup
-------------------
External SearXNG:
- ENABLE_SEARCH_WEB=true
- SEARCH_SEARXNG_URL=http://192.168.50.153:30053

Optional OpenRouter for web-answer synthesis:
- OPENROUTER_WEB_SEARCH_ENABLED=true
- OPENROUTER_API_KEY=<your_key>
- OPENROUTER_MODEL=<model_id>
- OPENROUTER_BASE_URL=https://openrouter.ai/api/v1

7) Home Assistant Voice Setup
-----------------------------
Base URL:
- http://<fulloch-host>:8000/v1

Endpoints:
- Chat: /chat/completions
- STT: /audio/transcriptions
- TTS: /audio/speech

If API auth enabled:
- Use FULLOCH_API_KEY as Bearer token in HA

Optional Home Assistant tool integration:
- ENABLE_HOME_ASSISTANT=true
- HOME_ASSISTANT_URL=http://<ha-host>:8123
- HOME_ASSISTANT_TOKEN=<ha_long_lived_token>
- HOME_ASSISTANT_ENTITY_ALIASES={"living room lights":"light.living_room"}

Music Assistant speaker playback compatibility:
- ENABLE_MUSIC_ASSISTANT=true
- MUSIC_ASSISTANT_DEFAULT_PLAYER=media_player.living_room
- MUSIC_ASSISTANT_PLAYER_ALIASES={"kitchen speaker":"media_player.kitchen"}

8) Optional Tool Flags
----------------------
Enable integrations as needed:
- ENABLE_SPOTIFY
- ENABLE_PHILIPS_HUE
- ENABLE_GOOGLE_CALENDAR
- ENABLE_AIRTOUCH
- ENABLE_THINQ
- ENABLE_WEBOS
- ENABLE_PIONEER_AVR

See .env.example for the full variable list.

9) Troubleshooting
------------------
- Pull issues: check GHCR visibility/login
- No web answers: verify SEARCH_SEARXNG_URL reachability
- OpenRouter not used: check OPENROUTER_WEB_SEARCH_ENABLED/API key/model
- HA connection issues: verify host, port, firewall, and bearer token
